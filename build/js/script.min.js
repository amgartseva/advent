"use strict";let taskContainer=document.querySelector(".task"),taskContent=taskContainer.querySelector(".task__content"),taskTitleTemplate=taskContainer.querySelector("#task-content").content.querySelector(".task__title"),taskTextTemplate=taskContainer.querySelector("#task-content").content.querySelector(".task__text"),taskButtonContainer=taskContainer.querySelector(".task__button-container"),changeActivityButton=taskButtonContainer.querySelector("#change-button"),setActivityButton=taskButtonContainer.querySelector("#set-button"),houses=document.querySelectorAll(".house__checkbox"),daysData,tasksData;function renderCheckedHouses(){let a=JSON.parse(window.localStorage.getItem(daysData));a?houses.forEach(function(t){var e=t.id-1;!0===a[e].isChecked&&(t.checked=!0)}):alert("I'm that random bug that prevents you from enjoying the calendar! Boo! (Reload the page, please T_T)")}function clickOnHouse(t){var e=JSON.parse(window.localStorage.getItem(daysData)),a=t.currentTarget.id-1;let n,o;var s=e[a].canBeChanged;t.currentTarget.checked?(e[a].isChecked=!0,n=e[a].day,o=getTaskText(a,e),updateLocalStorage(daysData,e)):(t.preventDefault(),t.currentTarget.checked=!0,n=e[a].day,o=e[a].task),drawTaskInfo(n,o,s,a)}function getRandomNumber(t,e){return Math.floor(Math.random()*(e-t+1))+t}function getTaskText(t,e){var a,n;return""!==e[t].task?(updateLocalStorage(daysData,e),e[t].task):(n=getRandomNumber(0,(a=JSON.parse(window.localStorage.getItem(tasksData))).length),e[t].task=a[n].text,e[t].task)}function clickOnChangeActivityButton(t){renderTaskText(getTaskText(t.currentTarget.dataset.houseId,JSON.parse(window.localStorage.getItem(daysData))))}function clickOnSetActivityButton(){taskButtonContainer.classList.add("task__button-container--hidden");var t=JSON.parse(window.localStorage.getItem(tasksData)),e=JSON.parse(window.localStorage.getItem(daysData));let a=taskContent.querySelector(".task__text").textContent;var n=t.find(t=>t.text===a);t.splice(n,1),updateLocalStorage(tasksData,t),updateLocalStorage(daysData,e),console.log(t)}function updateLocalStorage(t,e){window.localStorage.setItem(t,JSON.stringify(e))}function drawTaskInfo(t,e,a,n){renderTaskTitle(t),renderTaskText(e),renderTaskButtons(a,n)}function renderTaskTitle(t){var e=taskContainer.querySelector(".task__title");e?e.textContent=t:((e=taskTitleTemplate.cloneNode(!0)).textContent=t,taskContent.insertBefore(e,null))}function renderTaskText(t){var e=taskContainer.querySelector(".task__text");e?e.textContent=t:((e=taskTextTemplate.cloneNode(!0)).textContent=t,taskContent.insertBefore(e,null))}function renderTaskButtons(t,e){taskButtonContainer.classList.contains("task__button-container--hidden")?t&&(taskButtonContainer.classList.remove("task__button-container--hidden"),changeActivityButton.dataset.houseId=e,setActivityButton.dataset.houseId=e):t||taskButtonContainer.classList.add("task__button-container--hidden")}function getDataFromJSON(){0===localStorage.length?(fetch("../json/days_data.json").then(t=>t.json()).then(t=>daysData=t).then(()=>window.localStorage.setItem(daysData,JSON.stringify(daysData))),fetch("../json/tasks.json").then(t=>t.json()).then(t=>tasksData=t).then(()=>window.localStorage.setItem(tasksData,JSON.stringify(tasksData)))):(fetch("../json/days_data.json").then(t=>t.json()).then(t=>daysData=t),fetch("../json/tasks.json").then(t=>t.json()).then(t=>tasksData=t).then(()=>renderCheckedHouses()))}changeActivityButton.addEventListener("click",clickOnChangeActivityButton),setActivityButton.addEventListener("click",clickOnSetActivityButton),houses.forEach(function(t){t.addEventListener("change",clickOnHouse)}),getDataFromJSON();